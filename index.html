<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ruleta Casino</title>
  <style>
    body {
      background-color: #111;
      color: white;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    h1 {
      margin-top: 20px;
    }

    .roulette-container {
      display: flex;
      justify-content: center;
      margin: 30px auto;
    }

    .wheel-wrapper {
      position: relative;
      width: 400px;
      height: 400px;
    }

    #wheel {
      width: 100%;
      height: 100%;
      transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
      transform-origin: 50% 50%;
    }

    .ball {
      position: absolute;
      top: 5px;
      left: 50%;
      width: 15px;
      height: 15px;
      margin-left: -7.5px;
      background-color: white;
      border-radius: 50%;
      z-index: 10;
    }

    .controls {
      margin: 20px auto;
    }

    input, select, button {
      padding: 8px;
      margin: 5px;
      font-size: 1rem;
      border-radius: 4px;
      border: none;
    }

    button {
      background-color: #28a745;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #218838;
    }

    #result {
      margin-top: 20px;
      font-size: 1.2rem;
    }

    /* Estilos para la tabla de apuestas */
    #bet-table {
      display: grid;
      grid-template-columns: 40px repeat(12, 40px);
      grid-template-rows: repeat(3, 40px) 40px 40px;
      gap: 2px;
      width: max-content;
      margin: 0 auto 20px auto;
      background: #176a2a;
      padding: 12px 8px 8px 8px;
      border-radius: 12px;
      box-shadow: 0 0 16px #000a;
    }

    .bet-cell {
      width: 38px;
      height: 38px;
      font-size: 1rem;
      border: 2px solid #222;
      border-radius: 6px;
      cursor: pointer;
      background: #eee;
      color: #111;
      transition: outline 0.2s, box-shadow 0.2s;
      margin: 0;
      padding: 0;
    }

    .bet-cell.selected {
      outline: 3px solid yellow;
      box-shadow: 0 0 8px yellow;
      z-index: 2;
    }

    .bet-cell[data-value="0"] {
      background: green;
      color: white;
      font-weight: bold;
      grid-row: 1 / span 1; /* Solo una fila */
      grid-column: 1;
      height: 38px; /* Igual que los otros */
    }

    .roulette-table {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      grid-template-rows: repeat(5, 1fr);
      gap: 4px;
      width: 500px;
      margin: 0 auto 20px auto;
      justify-content: center;
      align-items: center;
    }

    .roulette-table .bet-cell {
      width: 100%;
      height: 100%;
      margin: 0;
      font-size: 1rem;
      border: 2px solid #222;
      border-radius: 6px;
      cursor: pointer;
      transition: outline 0.2s, box-shadow 0.2s;
    }

    .roulette-table .bet-cell.selected {
      outline: 3px solid yellow;
      box-shadow: 0 0 8px yellow;
      z-index: 2;
    }
  </style>
</head>
<body>
  <h1>Ruleta CHANCHONA🐷</h1>

  <div class="roulette-container">
    <div class="wheel-wrapper">
      <svg id="wheel" viewBox="0 0 400 400"></svg>
      <div class="ball"></div>
    </div>
  </div>

  <!-- Tabla de Apuestas -->
  <div id="bet-table" class="roulette-table">
    <!-- Fila 0 -->
    <button class="bet-cell" data-type="number" data-value="0" style="grid-row: 1; grid-column: 1;">0</button>
    <!-- Números 1-36 en 3 filas y 12 columnas -->
    <!-- Se generarán con JS -->
    <!-- Docenas y otras apuestas especiales -->
    <button class="bet-cell" data-type="dozen" data-value="1ra docena" style="grid-row: 4; grid-column: 2 / span 4;">1ra Docena</button>
    <button class="bet-cell" data-type="dozen" data-value="2da docena" style="grid-row: 4; grid-column: 6 / span 4;">2da Docena</button>
    <button class="bet-cell" data-type="dozen" data-value="3ra docena" style="grid-row: 4; grid-column: 10 / span 4;">3ra Docena</button>
    <button class="bet-cell" data-type="low" data-value="1-18" style="grid-row: 5; grid-column: 2 / span 2;">1-18</button>
    <button class="bet-cell" data-type="parity" data-value="par" style="grid-row: 5; grid-column: 4 / span 2;">Par</button>
    <button class="bet-cell" data-type="color" data-value="rojo" style="grid-row: 5; grid-column: 6 / span 2; background:red; color:white;">Rojo</button>
    <button class="bet-cell" data-type="color" data-value="negro" style="grid-row: 5; grid-column: 8 / span 2; background:black; color:white;">Negro</button>
    <button class="bet-cell" data-type="parity" data-value="impar" style="grid-row: 5; grid-column: 10 / span 2;">Impar</button>
    <button class="bet-cell" data-type="high" data-value="19-36" style="grid-row: 5; grid-column: 12 / span 2;">19-36</button>
  </div>

  <div id="chips-panel" style="margin: 16px 0;">
    <button class="chip" data-value="10" style="background:#eee; color:#222;">10</button>
    <button class="chip" data-value="50" style="background:#f4d35e; color:#222;">50</button>
    <button class="chip" data-value="100" style="background:#ee964b; color:#222;">100</button>
    <button class="chip" data-value="500" style="background:#f95738; color:#fff;">500</button>
  </div>
  <p id="selected-chip" style="margin-bottom:10px;">Ficha seleccionada: <b>10</b></p>

    <button onclick="spin()">Girar ruleta</button>


  <p id="result"></p>
  <div id="history" style="margin-top:16px; font-size:1.1rem;"></div>

  <script>
    const svg = document.getElementById("wheel");
    const red = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
    const black = [2,4,6,8,10,11,13,15,17,20,22,24,26,28,29,31,33,35];
    const numbers = [
      0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10,
      5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26
    ];
    const total = numbers.length;
    const centerX = 200;
    const centerY = 200;
    const radius = 190;
    const textRadius = 160;

    function drawWheel() {
      svg.innerHTML = "";
      for (let i = 0; i < total; i++) {
        const angle = (2 * Math.PI / total) * i;
        const nextAngle = (2 * Math.PI / total) * (i + 1);
        const num = numbers[i];
        const color = red.includes(num) ? 'red' : black.includes(num) ? 'black' : 'green';

        const x1 = centerX + radius * Math.cos(angle);
        const y1 = centerY + radius * Math.sin(angle);
        const x2 = centerX + radius * Math.cos(nextAngle);
        const y2 = centerY + radius * Math.sin(nextAngle);

        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        const d = `M${centerX},${centerY} L${x1},${y1} A${radius},${radius} 0 0,1 ${x2},${y2} Z`;
        path.setAttribute("d", d);
        path.setAttribute("fill", color);
        svg.appendChild(path);

        const textAngle = angle + (Math.PI / total);
        const tx = centerX + textRadius * Math.cos(textAngle);
        const ty = centerY + textRadius * Math.sin(textAngle);
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", tx);
        text.setAttribute("y", ty);
        text.setAttribute("fill", "white");
        text.setAttribute("font-size", "12");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("alignment-baseline", "middle");
        text.setAttribute("transform", `rotate(${(textAngle * 180 / Math.PI)}, ${tx}, ${ty})`);
        text.textContent = num;
        svg.appendChild(text);
      }
    }

    drawWheel();

    // Generar botones del 1 al 36
    const numbersDiv = document.querySelector('#bet-table');
    for (let i = 1; i <= 36; i++) {
      const btn = document.createElement('button');
      btn.className = 'bet-cell';
      btn.dataset.type = 'number';
      btn.dataset.value = i;
      btn.textContent = i;
      btn.style.width = '40px';
      btn.style.height = '40px';
      btn.style.margin = '2px';
      btn.style.background = red.includes(i) ? 'red' : black.includes(i) ? 'black' : 'white';
      btn.style.color = red.includes(i) ? 'white' : 'white';
      numbersDiv.appendChild(btn);
    }

    let currentRotation = 0; // Agrega esto fuera de la función spin()
    let selectedBets = [];
    let history = [];

    function spin() {
      const resultP = document.getElementById("result");

      const vueltas = 6;
      const randomAngle = Math.floor(Math.random() * 360);
      currentRotation += 360 * vueltas + randomAngle;
      svg.style.transform = `rotate(${currentRotation}deg)`;

      const degreesPerSector = 360 / total;
      const finalAngle = (360 - (currentRotation % 360) - 90 + 360) % 360;
      const index = Math.floor(finalAngle / degreesPerSector);
      const landedNumber = numbers[index];

      setTimeout(() => {
        const color = red.includes(landedNumber)
          ? "rojo"
          : black.includes(landedNumber)
          ? "negro"
          : "verde";
        const parity = landedNumber === 0 ? null : landedNumber % 2 === 0 ? "par" : "impar";
        let dozen = '';
        if (landedNumber >= 1 && landedNumber <= 12) dozen = '1ra docena';
        else if (landedNumber >= 13 && landedNumber <= 24) dozen = '2da docena';
        else if (landedNumber >= 25 && landedNumber <= 36) dozen = '3ra docena';

        let messages = [];
        if (selectedBets.length === 0) {
          messages.push(`Salió el ${landedNumber}`);
        } else {
          messages = selectedBets.map(bet => {
            let win = false;
            switch (bet.type) {
              case "number":
                win = parseInt(bet.value) === landedNumber;
                break;
              case "color":
                win = bet.value === color;
                break;
              case "parity":
                win = landedNumber !== 0 && bet.value === parity;
                break;
              case "dozen":
                win = bet.value === dozen;
                break;
              case "low":
                win = landedNumber >= 1 && landedNumber <= 18;
                break;
              case "high":
                win = landedNumber >= 19 && landedNumber <= 36;
                break;
            }
            return win
              ? `✅ ${bet.type} ${bet.value} ($${bet.amount}): ¡Ganaste!`
              : `❌ ${bet.type} ${bet.value} ($${bet.amount}): Perdiste.`;
          });
        }
        resultP.innerHTML = messages.join("<br>");

        // Limpiar montos visuales y apuestas
        document.querySelectorAll('.bet-amount').forEach(el => el.remove());
        selectedBets = [];
      }, 4200);
    }

    let betTable = document.getElementById('bet-table');
    betTable.addEventListener('click', function(e) {
      if (e.target.classList.contains('bet-cell')) {
        const type = e.target.dataset.type;
        const value = e.target.dataset.value;
        let bet = selectedBets.find(b => b.type === type && b.value === value);
        if (bet) {
          bet.amount += selectedChipValue;
        } else {
          selectedBets.push({ type, value, amount: selectedChipValue });
        }
        // Mostrar la cantidad apostada en el botón
        e.target.querySelector('.bet-amount')?.remove();
        const span = document.createElement('span');
        span.className = 'bet-amount';
        span.style.position = 'absolute';
        span.style.right = '2px';
        span.style.bottom = '2px';
        span.style.background = 'rgba(0,0,0,0.7)';
        span.style.color = 'yellow';
        span.style.fontSize = '0.9em';
        span.style.padding = '1px 4px';
        span.style.borderRadius = '6px';
        span.textContent = bet ? bet.amount : selectedChipValue;
        e.target.style.position = 'relative';
        e.target.appendChild(span);

        // Mostrar apuestas seleccionadas
        document.getElementById("result").textContent =
          selectedBets.length
            ? "Apuestas: " + selectedBets.map(b => `${b.type}: ${b.value} ($${b.amount})`).join(" | ")
            : "Selecciona tus apuestas";
      }
    });

    // Manejo de fichas
    let selectedChipValue = 10;
    document.querySelectorAll('.chip').forEach(chip => {
      chip.addEventListener('click', function() {
        selectedChipValue = parseInt(this.dataset.value);
        document.getElementById('selected-chip').innerHTML = `Ficha seleccionada: <b>${selectedChipValue}</b>`;
        document.querySelectorAll('.chip').forEach(c => c.style.outline = '');
        this.style.outline = '3px solid yellow';
      });
    });
    // Selecciona la primera ficha por defecto
    document.querySelector('.chip').style.outline = '3px solid yellow';
  </script>
</body>
</html>
