<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ruleta Casino</title>
  <style>
    body {
      background-color: #111;
      color: white;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 { margin-top: 20px; }
    .roulette-container {
      display: flex;
      justify-content: center;
      margin: 30px auto;
      position: relative;
    }
    .wheel-wrapper {
      position: relative;
      width: 400px;
      height: 400px;
    }
    #wheel {
      width: 100%;
      height: 100%;
      transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
      transform-origin: 50% 50%;
    }
    .ball {
      position: absolute;
      top: 5px;
      left: 50%;
      width: 15px;
      height: 15px;
      margin-left: -7.5px;
      background-color: white;
      border-radius: 50%;
      z-index: 10;
    }
    #bet-table {
      display: grid;
      grid-template-columns: 40px repeat(12, 40px);
      grid-template-rows: repeat(3, 40px) 40px 40px;
      gap: 2px;
      width: max-content;
      margin: 0 auto 20px auto;
      background: #176a2a;
      padding: 12px 8px 8px 8px;
      border-radius: 12px;
      box-shadow: 0 0 16px #000a;
      position: relative;
    }
    .bet-cell {
      width: 38px;
      height: 38px;
      font-size: 1rem;
      border: 2px solid #222;
      border-radius: 6px;
      cursor: pointer;
      background: #eee;
      color: #111;
      transition: outline 0.2s, box-shadow 0.2s;
      margin: 0;
      padding: 0;
      position: relative;
    }
    .bet-cell.selected {
      outline: 3px solid yellow;
      box-shadow: 0 0 8px yellow;
      z-index: 2;
    }
    .bet-cell[data-value="0"] {
      background: green;
      color: white;
      font-weight: bold;
      grid-row: 1 / span 3;
      grid-column: 1;
      height: 120px;
    }
    .bet-amount {
      pointer-events: none;
      font-weight: bold;
      font-size: 1.1em;
      background: #222;
      color: #ffd700;
      border: 1px solid #fff;
      position: absolute;
      right: 2px;
      bottom: 2px;
      padding: 1px 4px;
      border-radius: 6px;
    }
    #chips-panel {
      margin: 16px 0;
    }
    .chip {
      width: 48px;
      height: 48px;
      font-size: 1.1rem;
      border-radius: 50%;
      border: 2px solid #222;
      margin: 0 8px;
      cursor: pointer;
      font-weight: bold;
      transition: outline 0.2s;
    }
    .chip.selected, .chip:focus {
      outline: 3px solid yellow;
    }
    #history-pile {
      position: absolute;
      top: 0;
      right: -90px;
      width: 48px;
      height: 220px;
      display: flex;
      flex-direction: column-reverse;
      align-items: center;
      padding: 0;
      background: none;
      box-shadow: none;
      border-radius: 0;
      overflow-y: hidden;
    }
    .history-chip {
      width: 38px;
      height: 38px;
      border-radius: 6px;
      border: 2px solid #222;
      margin-bottom: 6px;
      font-size: 1.1rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 6px #000a;
    }
    .history-chip.red { background: red; color: white; }
    .history-chip.black { background: black; color: white; }
    .history-chip.green { background: green; color: white; }
  </style>
</head>
<body>
  <h1>Ruleta CHANCHONAüê∑</h1>
  <div class="roulette-container">
    <div class="wheel-wrapper">
      <svg id="wheel" viewBox="0 0 400 400"></svg>
      <div class="ball"></div>
    </div>
    <div id="history-pile"></div>
  </div>

  <!-- Tabla de Apuestas tipo casino horizontal -->
  <div id="bet-table"></div>

  <div id="chips-panel">
    <button class="chip" data-value="10" style="background:#eee; color:#222;">10</button>
    <button class="chip" data-value="50" style="background:#f4d35e; color:#222;">50</button>
    <button class="chip" data-value="100" style="background:#ee964b; color:#222;">100</button>
    <button class="chip" data-value="500" style="background:#f95738; color:#fff;">500</button>
  </div>
  <p id="selected-chip" style="margin-bottom:10px;">Ficha seleccionada: <b>10</b></p>
  <p id="saldo" style="font-size:1.3rem; margin: 10px 0;">Saldo: $<b>300</b></p>
  <button onclick="spin()">Girar ruleta</button>
  <p id="result"></p>

  <script>
    // --- DATOS Y RUEDA ---
    const svg = document.getElementById("wheel");
    const red = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
    const black = [2,4,6,8,10,11,13,15,17,20,22,24,26,28,29,31,33,35];
    const numbers = [
      0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10,
      5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26
    ];
    const total = numbers.length;
    const centerX = 200;
    const centerY = 200;
    const radius = 190;
    const textRadius = 160;

    function drawWheel() {
      svg.innerHTML = "";
      for (let i = 0; i < total; i++) {
        const angle = (2 * Math.PI / total) * i;
        const nextAngle = (2 * Math.PI / total) * (i + 1);
        const num = numbers[i];
        const color = red.includes(num) ? 'red' : black.includes(num) ? 'black' : 'green';

        const x1 = centerX + radius * Math.cos(angle);
        const y1 = centerY + radius * Math.sin(angle);
        const x2 = centerX + radius * Math.cos(nextAngle);
        const y2 = centerY + radius * Math.sin(nextAngle);

        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        const d = `M${centerX},${centerY} L${x1},${y1} A${radius},${radius} 0 0,1 ${x2},${y2} Z`;
        path.setAttribute("d", d);
        path.setAttribute("fill", color);
        svg.appendChild(path);

        const textAngle = angle + (Math.PI / total);
        const tx = centerX + textRadius * Math.cos(textAngle);
        const ty = centerY + textRadius * Math.sin(textAngle);
        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", tx);
        text.setAttribute("y", ty);
        text.setAttribute("fill", "white");
        text.setAttribute("font-size", "12");
        text.setAttribute("text-anchor", "middle");
        text.setAttribute("alignment-baseline", "middle");
        text.setAttribute("transform", `rotate(${(textAngle * 180 / Math.PI)}, ${tx}, ${ty})`);
        text.textContent = num;
        svg.appendChild(text);
      }
    }
    drawWheel();

    // --- TABLA DE APUESTAS HORIZONTAL ---
    const betTable = document.getElementById('bet-table');
    betTable.innerHTML = '';

    // Bot√≥n 0 (una sola celda a la izquierda)
    const btn0 = document.createElement('button');
    btn0.className = 'bet-cell';
    btn0.dataset.type = 'number';
    btn0.dataset.value = 0;
    btn0.textContent = '0';
    btn0.style.gridRow = '1 / span 3';
    btn0.style.gridColumn = '1';
    btn0.style.background = 'green';
    btn0.style.color = 'white';
    betTable.appendChild(btn0);

    // N√∫meros 1-36 en 3 filas y 12 columnas (horizontal)
    let num = 1;
    for (let row = 1; row <= 3; row++) {
      for (let col = 2; col <= 13; col++) {
        if (num > 36) break;
        const btn = document.createElement('button');
        btn.className = 'bet-cell';
        btn.dataset.type = 'number';
        btn.dataset.value = num;
        btn.textContent = num;
        btn.style.gridRow = row;
        btn.style.gridColumn = col;
        btn.style.background = red.includes(num) ? 'red' : black.includes(num) ? 'black' : 'white';
        btn.style.color = red.includes(num) ? 'white' : black.includes(num) ? 'white' : 'black';
        betTable.appendChild(btn);
        num++;
      }
    }

    // Docenas y otras apuestas especiales (debajo de los n√∫meros)
    const specials = [
      { type: 'dozen', value: '1ra docena', text: '1st 12', row: 4, col: 2, span: 4 },
      { type: 'dozen', value: '2da docena', text: '2nd 12', row: 4, col: 6, span: 4 },
      { type: 'dozen', value: '3ra docena', text: '3rd 12', row: 4, col: 10, span: 4 },
      { type: 'low', value: '1-18', text: '1-18', row: 5, col: 2, span: 2 },
      { type: 'parity', value: 'par', text: 'Even', row: 5, col: 4, span: 2 },
      { type: 'color', value: 'rojo', text: 'üî¥', row: 5, col: 6, span: 2 },
      { type: 'color', value: 'negro', text: '‚ö´', row: 5, col: 8, span: 2 },
      { type: 'parity', value: 'impar', text: 'Odd', row: 5, col: 10, span: 2 },
      { type: 'high', value: '19-36', text: '19-36', row: 5, col: 12, span: 2 }
    ];
    specials.forEach(s => {
      const btn = document.createElement('button');
      btn.className = 'bet-cell';
      btn.dataset.type = s.type;
      btn.dataset.value = s.value;
      btn.textContent = s.text;
      btn.style.gridRow = s.row;
      btn.style.gridColumn = `${s.col} / span ${s.span}`;
      betTable.appendChild(btn);
    });

    // --- FICHAS ---
    let selectedChipValue = 10;
    document.querySelectorAll('.chip').forEach(chip => {
      chip.addEventListener('click', function() {
        selectedChipValue = parseInt(this.dataset.value);
        document.getElementById('selected-chip').innerHTML = `Ficha seleccionada: <b>${selectedChipValue}</b>`;
        document.querySelectorAll('.chip').forEach(c => c.classList.remove('selected'));
        this.classList.add('selected');
      });
    });
    document.querySelector('.chip').classList.add('selected');

    // --- APUESTAS Y SALDO ---
    let saldo = 300;
    document.getElementById("saldo").innerHTML = `Saldo: $<b>${saldo}</b>`;
    let selectedBets = [];
    let history = [];
    let currentRotation = 0;

    betTable.addEventListener('click', function(e) {
      if (e.target.classList.contains('bet-cell')) {
        if (saldo < selectedChipValue) {
          alert("No tienes saldo suficiente para esa apuesta.");
          return;
        }
        saldo -= selectedChipValue;
        document.getElementById("saldo").innerHTML = `Saldo: $<b>${saldo}</b>`;

        const type = e.target.dataset.type;
        const value = e.target.dataset.value;
        let bet = selectedBets.find(b => b.type === type && b.value === value);
        if (bet) {
          bet.amount += selectedChipValue;
        } else {
          bet = { type, value, amount: selectedChipValue };
          selectedBets.push(bet);
        }
        // Mostrar la cantidad apostada en el bot√≥n (siempre el monto acumulado)
        e.target.querySelector('.bet-amount')?.remove();
        const span = document.createElement('span');
        span.className = 'bet-amount';
        span.textContent = bet.amount;
        e.target.appendChild(span);

        // Mostrar apuestas seleccionadas
        document.getElementById("result").textContent =
          selectedBets.length
            ? "Apuestas: " + selectedBets.map(b => `${b.type}: ${b.value} ($${b.amount})`).join(" | ")
            : "Selecciona tus apuestas";
      }
    });

    // --- GIRO Y RESULTADOS ---
    function spin() {
      const resultP = document.getElementById("result");
      const vueltas = 6;
      const randomAngle = Math.floor(Math.random() * 360);
      currentRotation += 360 * vueltas + randomAngle;
      svg.style.transform = `rotate(${currentRotation}deg)`;

      const degreesPerSector = 360 / total;
      const finalAngle = (360 - (currentRotation % 360) - 90 + 360) % 360;
      const index = Math.floor(finalAngle / degreesPerSector);
      const landedNumber = numbers[index];

      setTimeout(() => {
        const color = red.includes(landedNumber)
          ? "rojo"
          : black.includes(landedNumber)
          ? "negro"
          : "verde";
        const parity = landedNumber === 0 ? null : landedNumber % 2 === 0 ? "par" : "impar";
        let dozen = '';
        if (landedNumber >= 1 && landedNumber <= 12) dozen = '1ra docena';
        else if (landedNumber >= 13 && landedNumber <= 24) dozen = '2da docena';
        else if (landedNumber >= 25 && landedNumber <= 36) dozen = '3ra docena';

        let messages = [];
        let totalGanado = 0;
        if (selectedBets.length === 0) {
          messages.push(`Sali√≥ el ${landedNumber}`);
        } else {
          messages = selectedBets.map(bet => {
            let win = false, pago = 0;
            switch (bet.type) {
              case "number":
                win = parseInt(bet.value) === landedNumber;
                pago = 36;
                break;
              case "color":
                win = bet.value === color;
                pago = 2;
                break;
              case "parity":
                win = landedNumber !== 0 && bet.value === parity;
                pago = 2;
                break;
              case "dozen":
                win = bet.value === dozen;
                pago = 3;
                break;
              case "low":
                win = landedNumber >= 1 && landedNumber <= 18;
                pago = 2;
                break;
              case "high":
                win = landedNumber >= 19 && landedNumber <= 36;
                pago = 2;
                break;
              case "column":
                let colNum = parseInt(bet.value.replace('col',''));
                win = (landedNumber !== 0) && ((landedNumber - 1) % 3 === (colNum - 1));
                pago = 3;
                break;
            }
            if (win) {
              saldo += bet.amount * pago;
              totalGanado += bet.amount * pago;
            }
            return win
              ? `‚úÖ ${bet.type} ${bet.value} ($${bet.amount}): ¬°Ganaste $${bet.amount * pago}!`
              : `‚ùå ${bet.type} ${bet.value} ($${bet.amount}): Perdiste.`;
          });
        }
        resultP.innerHTML = messages.join("<br>");
        document.getElementById("saldo").innerHTML = `Saldo: $<b>${saldo}</b>`;

        // Agregar resultado al historial
        addToHistory(landedNumber);

        // Limpiar montos visuales y apuestas
        document.querySelectorAll('.bet-amount').forEach(el => el.remove());
        selectedBets = [];
      }, 4200);
    }

    // --- HISTORIAL ---
    function addToHistory(landedNumber) {
      const historyPile = document.getElementById("history-pile");
      const colorClass = red.includes(landedNumber)
        ? "red"
        : black.includes(landedNumber)
        ? "black"
        : "green";
      const chip = document.createElement("div");
      chip.className = `history-chip ${colorClass}`;
      chip.textContent = landedNumber;
      historyPile.prepend(chip);
      while (historyPile.childElementCount > 10) {
        historyPile.lastChild.remove();
      }
    }
  </script>
</body>
</html>
